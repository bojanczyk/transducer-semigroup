\section{Introduction}
\label{sec:intro}

The purpose of this paper is to give a characterization of the regular string-to-string functions. This is a fundamental class of functions, which has many equivalent descriptions, including: deterministic two-way automata~\cite[Note~4]{shepherdson1959reduction}, copyless streaming string transducers (\sst)~\cite[Section~3]{alurExpressivenessStreamingString2010} (or the earlier and very similar single use restricted macro tree transducers~\cite[Section~5]{MacroMSO}), \mso transductions~\cite[Theorem~13]{engelfrietMSODefinableString2001}, combinators~\cite[Section~2]{alur2014regular}, a functional programming language~\cite[Section~6]{bojanczykRegularFirstOrderList2018}, $\lambda$-calculus with linear types~\cite[Theorem~3]{LambdaTransducer} (see also~\cite[Claim~6.2]{IATLC} and~\cite[Theorem~1.2.3]{titoPhD}), decompositions \textit{Ã  la} Krohn--Rhodes~\cite[Theorem~18, item~4]{bojanczykstefanski2020}, etc.

The number of equivalent decriptions clearly indicates that the class is important and worth studying. However, from a mathematical point of view, a disappointing phenomenon is that each of the classes described above has a rather elaborate syntax. For example, the definition of a two-way automaton requires a discussion of endmarkers and what happens when the automaton loops. In an \mso transduction, we need to use annotate elements of the input string using extra colours for copying. In a streaming string transducer, one needs to be careful about bounding the copies among registers, and there are some delicate quetions regarding lookahead. Each of the combinator calculi has a long list of combinators. Similar remarks apply to the other calculi.

This situation is in contrast with the regular languages, which have beautiful definitions with minimal syntax, such as recognizability by finite semigroups. The present paper attempt to address this issue, by adding a new characterization of the regular string-to-string functions, which uses minimal syntax, and refers only to basic concepts from algebra and category theory. 
We prove that a string-to-string function of type $\Sigma^* \to \Gamma^*$ is regular
%, in the sense that it is recognized by any of the equivalent models described in the previous paragraph,
if and only if it can be decomposed as 
\[
\begin{tikzcd}
    \Sigma^* 
    \ar[r,"h"]
    & 
    \functor(\Gamma^*)
    \ar[r,"\outfun_{\Gamma^*}"]
    &
    \Gamma^*
\end{tikzcd}
\]
where $\functor$ is some finiteness-preserving functor from the category of semigroups to itself, $h$~is some semigroup homomorphism, and the output function $\outfun_{\Gamma^*}$ is a natural transformation.
\tito{oops, forgot to specify that $\outfun$ goes from semigroups to sets}
%Here, a finiteness-preserving functor is one that maps finite semigroups to finite semigroups. 
%\tito{I figure this is explicited anyways in the dedicated section}

This result (\Cref{thm:regular-functions}) also extends to some other algebraic structures, such as trees modelled via forest algebra. However, our proof uses properties of the underlying algebraic structure which seem to fail for some structures such as groups or algebras corresponding to weighted automata; we do not know if our proof can be extended to  these structures, or even if the theorem itself is true.

%  this means that functors such as $A \mapsto A^2$ are allowed, but not $A \mapsto A^+$. 